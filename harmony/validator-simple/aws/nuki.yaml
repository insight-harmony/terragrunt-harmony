---

version_:
  type: yaml
  path: versions.yaml

provider:
  type: stat
  input: aws

region:
  type: stat
  input: "{{ nuki.aws_region }}"

#secrets:
#  type: nukikata
#  merge: true
#  context_file: "{{ nuki.secrets_file_ }}"
#  existing_context: "{{ nuki }}"

node:
  type: nukikata
  merge: true
  template: https://github.com/insight-harmony/terraform-harmony-aws-node
  checkout: "{{ nuki.version_[nuki.environment] }}"
  existing_context: "{{ nuki }}"

# Write Deployment
write_:
  type: nukikata
  context_file: "{{ nuki.scripts_dir_ }}/write.yaml"
  existing_context: "{{ nuki }}"

# Apply
apply_confirm_:
  type: confirm
  message: Do you want deploy now?

apply_:
  type: nukikata
  context_file: "{{ nuki.scripts_dir_ }}/apply.yaml"
  when: "{{ nuki.apply_confirm_ }}"
  existing_context: "{{ nuki }}"

